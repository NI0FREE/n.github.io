<!DOCTYPE html>
<html lang="en">
    <head>
        <style text="text/css">
            * { margin:0; padding:0; }
            html, body { width:100%; height:100%; }
            canvas { display:block; }
        </style>
    </head>
<body>
    <script src="file:///C:/Users/vasin/Desktop/helloworld/fabric.min%20(1).js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<div class="intro">
    <p id="log" style="position: absolute;">no logs</p>
    <canvas id="largecanv" ></canvas>
</div>
                
</body>
<script>
    
 let canvcanv = document.getElementById('largecanv');
 var ctx = canvcanv.getContext('2d');
 canvcanv.width=window.outerWidth;
 canvcanv.height=window.outerHeight;
 (function() {
       
        context = canvcanv.getContext('2d');
        canvcanv.width = window.innerWidth;
        canvcanv.height = window.innerHeight;
 })();

 function draw(size){
    ctx.clearRect(0, 0, canvcanv.width, canvcanv.height);
    ctx.fillStyle = "red";

    ctx.fillRect(gameX,gameY,size,size);
}


// "add" rectangle onto canvas

let gSize = 25,gameX=window.innerWidth/2,gameY=window.innerHeight/2,lastX=0,lastY=0;
let canvasDr = false;
draw(gSize)
canvcanv.addEventListener('mousedown', function (event) {
    canvasDr = true;

}, false);
canvcanv.addEventListener('mousemove', function (event) {
    if(canvasDr){
       gameX += event.clientX - lastX
       gameY += event.clientY - lastY
       
       draw(gSize)
    }
    lastX = event.clientX
    lastY = event.clientY

}, false);
canvcanv.addEventListener('mouseup', function () {
    canvasDr = false;
}, false);

function addOnWheel(elem, handler) {if (elem.addEventListener) {if ('onwheel' in document) {elem.addEventListener("wheel", handler);} else if ('onmousewheel' in document) {elem.addEventListener("mousewheel", handler);} else {elem.addEventListener("MozMousePixelScroll", handler);}}else{text.attachEvent("onmousewheel", handler);}}

addOnWheel(canvcanv, function(e) {
    let zoomP = 25;
    
    let xxx = Math.trunc(((gameX-lastX)*-1)/(gSize/zoomP)*1000)/1000
    let yyy = Math.trunc(((gameY-lastY)*-1)/(gSize/zoomP)*1000)/1000
    console.log("X: "+xxx+" Y: "+yyy)
    if(e.deltaY<0){//zoom
        gSize = gSize+zoomP;
        gameX = gameX-xxx;
        gameY = gameY-yyy;
        draw(gSize)
        
    }else
    if(gSize/zoomP>1){         //back
        gSize = gSize-zoomP;
        gameX = gameX+xxx;
        gameY = gameY+yyy;
        draw(gSize)
        
    }
    
    e.preventDefault();
});   
///////////////////////////////////////////////////phone
let log = document.getElementById('log')
        canvcanv.addEventListener("touchstart", function (event) {
            canvasDr = true;
            lastX = event.touches[0].clientX
            lastY = event.touches[0].clientY
            event.preventDefault();
        }, false); 

        canvcanv.addEventListener("touchmove", function (event) {
            let allTouches = event.touches.length;
            if(canvasDr && allTouches == 1){
                gameX += event.touches[0].clientX - lastX
                gameY += event.touches[0].clientY - lastY
                console.log("X: "+gameX+" Y: "+gameY)
                draw(gSize)
            } else 
            if (allTouches == 2){
                

                phoneZoom(event.touches[0],event.touches[1])
            }
            
            lastX = event.touches[0].clientX
            lastY = event.touches[0].clientY

            event.preventDefault();
        }, false,{passive: false});
        canvcanv.addEventListener("touchend", function (event) {
            canvasDr = false;
            
            event.preventDefault();
        }, false);

        let lastRaznX=0,lastRaznY=0;
        function phoneZoom(one,two){
            let xZoomPH;
            let yZoomPH;
            let raznX = one.clientX-two.clientX;
            let raznY = one.clientY-two.clientY;
            if( lastRaznX == 0 && lastRaznY ==0){
                lastRaznX = raznX;
                lastRaznY = raznY;
            }else{

                xZoomPH = lastRaznX-raznX; 
                yZoomPH = lastRaznY-raznY;
                ZoomPH = xZoomPH+yZoomPH;
                log.innerHTML = "one: "+ZoomPH;

                lastRaznX = raznX;
                lastRaznY = raznY;
            }

            
            
        }



//////////////////////////////////////////////////////


// document.getElementsByClassName('canvas-container')[0].style.top= "-8px";
// document.getElementsByClassName('canvas-container')[0].style.left= "-8px";
</script>
</html
